---
title: Behavior Metrics tutorial using Tensoflow <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2d/Tensorflow_logo.svg/1200px-Tensorflow_logo.svg.png" alt="TF logo" width="50"/> 
layout: posts
permalink: /quick_start/tutorial

collection: posts

classes: wide

sidebar:
  nav: "docs"
  
---

In this tutorial, you will train your first follow line brain for the F1 that can be run on Behavior Metrics.

## Table of Contents

- [Table of Contents](#table-of-contents)
- [Prerequisites](#prerequisites)
- [Brain Class](#brain-class)
- [Training a Brain](#training-a-brain)


## Prerequisites

First of all, make sure you have Behavior Metrics installed, following the [installation section](/install/). You can try running the *brain_f1_explicit* that is already included on Behavior Metrics brains folder. This brain is capable of finishing every circuit available for the project.

## Brain Class

There are three main functions that can be used to for performing I/O operations on the robot. You can also find a [dummy file](https://github.com/JdeRobot/BehaviorMetrics/blob/noetic-devel/behavior_metrics/brains/f1/brain_f1_dummy.py), with all the instructions, that you can use as a template for deployment.

**Update Frame**

Update the information to be shown in one of the GUI's frames.

Arguments:<br>
- frame_id {str} --  Id of the frame that will represent the data
- data {*} -- Data to be shown in the frame. Depending on the type of frame (rgbimage, laser, pose3d, etc)

```python
def update_frame(self, frame_id, data):
```

**Update Pose**

Update the pose 3D information obtained from the robot.

Arguments: <br>
- data {*} -- Data to be updated, will be retrieved later by the UI.

```python
def update_pose(self, pose_data):
```

**Execute**

Main loop of the brain. This will be called iteratively each TIME_CYCLE

```python
def execute(self):
```

## Training a Brain

All the deep learning brains with their code can be located at [Deep Learning Studio's repo](https://github.com/JdeRobot/DeepLearningStudio). 
For this tutorial, we will be using PilotNet architecture, a CNN based solution for self-driving cars. You can navigate to the previous repo to the
[Formula 1-Follow line folder](https://github.com/JdeRobot/DeepLearningStudio/tree/main/Formula1-FollowLine), where both implementations for pytorch and tensorflow are located. 
We will use tensorflow <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2d/Tensorflow_logo.svg/1200px-Tensorflow_logo.svg.png" alt="TF logo" width="20"/> . 

1. Follow the [steps](https://github.com/JdeRobot/DeepLearningStudio/tree/main/Formula1-FollowLine#tensorflow-) on that repo for generating a new deep learning model using tensorflow and PilotNet. On that repo you will find information about how to download the dataset
and how to train the model. Using the examples shown there should be fine for this tutorial (you can explore different combinations afterwards ðŸ˜„).

2. After training your first tensorflow model for the follow line problem, you will have a *.h5* file generated by the previous execution.

3. Take that *.h5* file and store it on *behavior_metrics/models/* creating a new folder *tensorflow_models*. 

4. We're almost ready to go. Modify the *DL-tensorflow.yml* file under *behavior_metrics/configs/* folder, changing the *Model:* '[your_model_name].h5' with your model name.

5. Execute Behavior Studio with the command.

```bash
python3 driver.py -c configs/default.yml -g
```

and your done. Press the **PLAY** button shown on the GUI and the f1 should be running!

**NOTE:** If you find any problem running this tutorial, create an issue on [Behavior Metrics](https://github.com/JdeRobot/BehaviorMetrics/issues/new) repo so we can help you.